<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="MicroWin - Therapeutic cognitive prosthetic for neurodivergent users overcoming task initiation paralysis">
    <title>MicroWin 2.0: Therapeutic Evolution</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Background Ornaments -->
    <div class="bg-ornament glow-1"></div>
    <div class="bg-ornament glow-2"></div>
    <div class="bg-ornament glow-3"
        style="width: 500px; height: 500px; background: radial-gradient(circle, var(--accent-success), transparent 70%); top: 40%; right: -100px; animation: float 18s infinite alternate ease-in-out; opacity: 0.1;">
    </div>

    <!-- Top HUD (XP & Level) -->
    <div class="top-hud fade-in">
        <div class="user-profile" id="currentProfile" title="Switch User Profile">
            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Avatar" id="userAvatar">
            <div class="user-info">
                <span id="userName" class="user-name">Loading...</span>
                <span id="userLevel" class="user-level">Lvl 1</span>
            </div>
        </div>
        <div class="xp-container">
            <div id="userXpBar" class="xp-bar" style="width: 0%"></div>
            <span id="xpText" class="xp-text">0 / 100 XP</span>
        </div>
    </div>

    <!-- Settings Panel (Top-right) -->
    <div class="settings-panel">
        <button id="insightsToggle" class="icon-btn" title="Cognitive Insights">
            <span>üìä</span>
        </button>
        <button id="dietToggle" class="icon-btn" title="Nutrition Anchors">
            <span>ü•ó</span>
        </button>
        <button id="fontToggle" class="icon-btn" title="Toggle Dyslexic Font">
            <span>Aa</span>
        </button>
    </div>

    <div class="container fade-in">
        <header class="header">
            <h1>MicroWin</h1>
            <p>Your Therapeutic Companion</p>
        </header>

        <main class="content">
            <!-- Screen 1: Task Input -->
            <section id="inputScreen" class="screen active">
                <div class="input-card">
                    <label for="taskInput" class="label-muted">What's the one thing on your mind?</label>
                    <textarea id="taskInput" class="task-input" placeholder="e.g., Clean the kitchen table..."
                        rows="3"></textarea>

                    <div class="input-actions-row">
                        <div class="energy-selector">
                            <span class="label-tiny">Your Energy:</span>
                            <div class="energy-options">
                                <button class="energy-btn" data-level="low" title="Smallest possible steps">üîã
                                    Low</button>
                                <button class="energy-btn active" data-level="medium" title="Standard micro-steps">üîã
                                    Med</button>
                                <button class="energy-btn" data-level="high" title="Steady progress steps">üîã
                                    High</button>
                            </div>
                        </div>
                        <button id="visionBtn" class="icon-btn vision-btn" title="Scan Environment with Vision">
                            <span>üëÅÔ∏è</span>
                        </button>
                    </div>

                    <button id="startBtn" class="primary-btn" disabled>
                        <span>Start Healing</span>
                        <span class="btn-shine"></span>
                    </button>
                </div>
            </section>

            <!-- Screen 2: Loading (Therapeutic) -->
            <section id="loadingScreen" class="screen">
                <div class="loading-container">
                    <div class="pulse-circle"></div>
                    <p class="loading-text">Identifying your first win...</p>
                    <p class="therapeutic-note">Take a deep breath. I've got the planning from here.</p>
                </div>
            </section>

            <!-- Screen 3: The Micro-Win -->
            <section id="stepScreen" class="screen">
                <div id="timelineSlices" class="timeline-slices"></div>
                <div class="step-content">
                    <div id="stepBadge" class="step-badge">~10 sec</div>
                    <h2 id="stepText">Touch the edge of the kitchen table</h2>

                    <div id="nextStepPreview" class="next-preview">
                        <span class="label-tiny">NEXT:</span>
                        <p id="nextStepText">Pick up one piece of paper</p>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="doneBtn" class="action-btn done-btn">
                        <span>Done</span>
                    </button>
                    <div class="secondary-actions">
                        <button id="tooHardBtn" class="action-btn hard-btn">Too Hard</button>
                        <button id="pauseBtn" class="action-btn pause-btn">Pause</button>
                        <button id="speakBtn" class="icon-btn small-btn" title="Read Aloud">
                            <span>üîä</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Screen 4: Paused -->
            <section id="pausedScreen" class="screen">
                <div class="paused-content">
                    <h2>Resting...</h2>
                    <p>Your win is waiting for you when you return.</p>
                    <button id="resumeTaskBtn" class="primary-btn">Resume Win</button>
                    <button class="newTaskLink text-link">Start a different task</button>
                </div>
            </section>

            <!-- Screen 5: Victory -->
            <section id="victoryScreen" class="screen">
                <div class="victory-content">
                    <div class="victory-icon">üèÜ</div>
                    <h2>Win Captured!</h2>
                    <p>Your dopamine is rising. Total wins: <span id="totalWins">0</span></p>
                    <button class="newTaskLink primary-btn">Next Objective</button>
                    <p class="therapeutic-note">You are making progress. Even small steps count.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Cognitive Insights -->
    <div id="insightsModal" class="modal">
        <div class="modal-content glass">
            <div class="modal-header">
                <h3>Cognitive Insights</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="insightsLoading">Analyzing patterns...</div>
            <div id="insightsData" class="insights-grid">
                <div class="insight-card">
                    <span class="label">Peak Clarity</span>
                    <span id="peakHourValue" class="value">--:00</span>
                </div>
                <div class="insight-card">
                    <span class="label">Style</span>
                    <span id="bestEnergyValue" class="value">--</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Nutrition Dashboard -->
    <div id="dietModal" class="modal">
        <div class="modal-content glass">
            <div class="modal-header">
                <h3>ADHD Anchors</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p class="label-muted">Lifestyle supports for cognitive stability.</p>
            <div id="dietList" class="diet-list"></div>
            <button id="addDietTargetBtn" class="secondary-btn">+ New Anchor</button>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content glass">
            <div class="modal-header">
                <h3>Profiles</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="userList" class="profile-grid"></div>
            <button id="createProfileBtn" class="secondary-btn">+ New Patient</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>